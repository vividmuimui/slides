#!/bin/sh

set -eu
dir=${1:?ディレクトリ名を1つ目の引数に実行してください}
name=${2:?slideタイトルを2つ目の引数に実行してください}
current_date=$(date +%Y/%m/%d)

mkdir -p "$dir"

LINK="https://vividmuimui.github.io/slides/$dir/slides"
if ! grep -e "$LINK" README.md > /dev/null
then
    echo "- $current_date [$name]($LINK)" >> README.md
fi

cd $dir

cp ../config/config.yml ./
cp -r ../config/css ./
cat << EOS >> config.yml
title: $name
meta_properties:
  og:type: "website"
  og:title: $name
  og:description: Slide about '$name'. ${current_date}. @vividmuimui . Generated by reveal-ck.
  og:url: "https://vividmuimui.github.io/slides/$name/slides"

meta_names:
  twitter:card: "summary"
  twitter:site: "@vividmuimui"
  twitter:creator: "@vividmuimui"
  twitter:title: $name
  twitter:description: Slide about '$name'. ${current_date}. @vividmuimui . Generated by reveal-ck.
EOS

if [ ! -e slide.md ]; then
  cat << EOS >> slide.md
# ${name}

@vividmuimui
${current_date}
EOS
fi

mkdir slides
bundle exec reveal-ck generate -f slide.md -d slides
# cat ../css/* >> ./slides/css/reveal.css
